##### 存储器容量单位

字:<font color=#F09B59 style=" font-weight:bold;">CPU一次能够处理数据位数的最大值</font>

存储字长:字的长度
比如32位计算机 1字=4字节=32位

cpu视角的存储单元:是一个相对概念
根据你寻址方式的不同,大小也不同

但总之,存储单元是CPU访问存储器的最小单位，每个存储单元都有一个地址。

比如容量为100G,按字节寻址,那就每个单元1B(一个字节)  那就有1×10^11个单元
32位计算机4KB 按字寻址,每个单元4B 那就1000个存储单元


操作系统视角的存储单元:较之于上一个概念,上一个概念更像一块一块的存储块
现代操作系统的存储单元是<font color=#F09B59 style=" font-weight:bold;">一个存储单元一个字节</font>

![](img/Pasted%20image%2020220901141527.png)

从上图可以看出每个字节的高地址位可以用以作为"一块"来更方便的寻址


##### 存储器有哪些?
* 高速缓冲cache
* 内存/主存
* 外存/硬盘/辅存

外存硬盘不与cpu直连,而是通过io将数据读取到内存中让cpu执行

内存,主存又包含
* RAM
* ROM
ROM,read only memory保存数据的方式是将数据烧刻到半导体上
所以是不能改的,后来也出现了可以改的
因为ROM不需要电就可以保存数据,刚开电脑是,初始化就是先从这里开始的
外存不是ROM因为外存可以修改数据,不是一次编程的

RAM read access memory随机存取存储器,掉电失效


![](img/Pasted%20image%2020220901190742.png)


##### 什么是空间局部性和事件局部性?
空间局部性
就是你下一个要访问的内存,大概率是你上一层访问内存的附近位置
时间局部性
你访问过的一个内存位置,有一定概率下面还要访问多次


##### 利用局部性原理对for循环分析优化
一句话
能使访问的内存位置聚集在一块对于程序执行速度更快

![](img/Pasted%20image%2020220902182916.png)

##### cache为什么能提高内存访问性能?
因为<font color=#F09B59 style=" font-weight:bold;">cache高速缓冲区作为一个硬件,cpu在读取时要远快于内存</font>
走cache这条道在命中数据的情况下,性能能提高很多
![](img/Pasted%20image%2020220902175701.png)

![](img/Pasted%20image%2020220901185313.png)



##### 什么是cache与主存的替换算法?
这个算法主要是为了应对cache满了,有想要从主存中读东西给cache,替换那一部分
的问题

策略有
FIFO先进先出
random随机替换
不常用数据替换

一般采用第三个,前面两个并不能保证局部性原理,经常命中的数据可能会被替换掉
第三种,拿一个字段计数器,每次访问都会对所有计数器加1
对命中的cache块置0
最后检查哪一块计数器最高,就将哪一块替换掉

##### cache命中时的读写策略有哪些?
这主要是应对cache与主存一致性的问题
在cache被修改后如何取包装盒主存也被修改

* 直接写入主存法
* 写回法

直接写入主存法:
每次访问命中后修改的cache块直接全部再写回到主存
这里用到了一个写缓冲,可以解决cache与主存之间的写入速度不同的问题
你想一下,cache写入到主存的时间很久,你每一次改,都要等cache将数据同步到主存,
不是很费时间吗?
所以我们创建了一个队列,让那些等待被同步到主存的cache块排队
当然也会引起一些问题
比如:
队排太长,这个缓冲队列溢出了

这个写缓冲相当于一个FIFO的队列


写回法:
不是一次修改就去同步类似于txt文件那样需要手动ctrl+s
那么这是如何实现的呢?
用一个字段去表示被修改的次数
这个字段叫"脏位"
当cache被访问修改一定次数后在统一去同步主存
特点:
可以有效减少写入主存的次数


##### 虚拟存储系统是什么?
将所有存储器的地址一页一页/段重新映射一下,抽象为一个虚拟存储器给操作系统
这个抽象出来的虚拟系统下的地址就是虚拟地址/逻辑地址

一个应用是只有部分被读入到内存中的
应用被分段或是分页被读取到
比如微信,一般读入文字聊天和朋友圈
游戏中进入游戏加载地图

![](img/Pasted%20image%2020220902210516.png)

有个字段用来表示该页是否被读进内存
若cpu需要该页且检测到该页的有效位为0,说面该页在辅存中
此时就会调用io接口将该页读取到内存中
![](img/Pasted%20image%2020220902211551.png)


计组与操作系统对于文件存储的层次不同

![](img/Pasted%20image%2020220902212134.png)