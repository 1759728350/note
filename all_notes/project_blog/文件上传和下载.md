#### 文件上传
知识点
File的创建,对于File接口的理解
与数据库的交互思考

思路:创建指定路径的文件,然后将文件通过transferTo写入到指定文件中


```java
  
@RestController  
public class UploaderController {  
  
    @Autowired  
    private FileMapper fileMapper;  
  
  
//    @Value("{myfile.root.filePath}")  
    private String filePath = "E:\\upload";  






    @PostMapping("/upload")  
    public String upload(@RequestParam("myFile")MultipartFile file){  
        if (file.isEmpty()){  
            return "文件为空";  
        }        //获取文件名  
        String originalFilename = file.getOriginalFilename();  
        System.out.println(originalFilename);  
        System.out.println(filePath); 


        //获取classpath  
        String basePath1 = this.getClass().getClassLoader().getResource("").getPath();  
        System.out.println(basePath1);  
        //添加uuid防止重名  
        String fileName = UUID.randomUUID().toString()+"-"+originalFilename;  


        //检查创建文件夹  
        File fileDir = new File(filePath);  
        if (!fileDir.exists()){  
            fileDir.mkdirs();  
        } 


        //创建文件  
        //文件存储在e盘,你不能将文件放到项目底下的static文件夹下  
        //毕竟你构建部署后已经打包,啥大文件别往里塞  
        File localFile = new File(filePath+"\\"+fileName);  
  
        try {  
        
            file.transferTo(localFile);  
            //还需将filrname保存到数据库  
            String id = UUID.randomUUID().toString();  
            fileMapper.insertFile(fileName,id);  
            return fileName;  
        
        } catch (IOException e) {  
            System.out.println("asdas");  
            return "fail";  
        }  
    }  





    @GetMapping("/all")  
    public List all(){  
        //查询上传的图片  
        List<Map<String, String>> mapList = fileMapper.select();  
        return mapList;  
  
    }}
```


fileMapper
```java
@Mapper  
public interface FileMapper {  
	//查询上传图片接口
    @MapKey("id")  
    public List<Map<String,String>> select();  
    //图片名插入数据库,方便以后下载
    @Insert("insert into jdbc_demo.file (file, id) VALUE (#{file},#{id})")  
    public boolean insertFile(@Param("file") String file, @Param("id") String id);  
}

```

通过map来接收复杂类型
毕竟一个对象的属性就是一组键值对,一个对象就是一个map

```xml

<?xml version="1.0" encoding="UTF-8" ?>  
<!--约束规则-->  
<!DOCTYPE mapper  
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">  
<!--namespace对应mapper接口的全类名-->  
<mapper namespace="com.example.demo.mapper.FileMapper">  
  
  
    <select id="select" resultType="java.util.Map">  
        select * from jdbc_demo.file  
    </select>  
</mapper>

```




html
```html
<!DOCTYPE html>  
<html lang="en">  
<head>  
    <meta charset="UTF-8">  
    <title>Title</title>  
</head>  
<body>  
<p>单文件上传</p>  
<form action="upload" method="post" enctype="multipart/form-data">  
    文件<input type="file" name="myFile">  
    <input type="submit">  
  
</form>  
</body>

```