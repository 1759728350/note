<font color=#99CCFF style=" font-weight:bold;">待施工</font>
硬件层面暂时滤过

学完操作系统/计网/数据结构后再来看



### 什么是io接口
io接口是一个硬件上的实现
具体就是由寄存器和各种总线构成
cpu控制从外部设备中读取数据,读取数据的地址,把这些数据<font color=#F09B59 style=" font-weight:bold;">读到内存里</font>
![](img/Pasted%20image%2020220913022238.png)

### 中断是什么
中断是多个程序/多个任务的切换管理者
比如可用于应对cpu通过io接口控制数据<font color=#66CC99 style=" font-weight:bold;">从外部设备读取到内存时
时间话费过大</font>,此时<font color=#F09B59 style=" font-weight:bold;">cpu处于忙等状态</font>
我们需要解放cpu,去执行其他程序
当io完成
io控制器发中断信号去通知cpu
我之前那个需要io读取数据的程序已经全准备好了
你快来执行
cpu就会回去执行那个程序

中断系统要求是在每个指令执行完后都取检查一遍中断信号

##### 非屏蔽中断
在关中断状态下仍会去执行的
像断电操作就是非屏蔽中断
即使处于关中断也是会强制响应的
紧急记录系统的状态

### 什么是原子操作
有一个概念:<font color=#66CC99 style=" font-weight:bold;">关中断</font>
意思就是关闭中断
存在意义是为了实现原子化操作

正常程序pc会一路执行下去
每次执行完后去检查中断信号,决定是否开启中断
执行其他程序
但是关中断后
只能执行完这一段程序才能跳转执行其他程序
![](img/Pasted%20image%2020220913021708.png)



### 中断执行过程
![](img/Pasted%20image%2020220913232133.png)
##### 中断隐指令
先获取到中断后程序的入口
从入口进入执行函数
关中断,原子执行该程序
保存pc指针指向的断点,用栈保存
执行完程序后再回到原来的断点
![](img/Pasted%20image%2020220913230701.png)


##### 保存现场
在执行中断程序之前
先将各寄存器的值给保存在堆栈中
因为你执行中断程序时
会把那些寄存器的给覆盖了,因此要保存状态
![](img/Pasted%20image%2020220913231742.png)


### 多重中断
多重中断是如何实现的?
利用屏蔽字
屏蔽字指出了多个中断之间的优先级问题

![](img/Pasted%20image%2020220913233620.png)

### printf和scanf
共同点:都涉及到io操作

scanf是等待键盘输入,所以不像下面的执行流程一样,异步执行io操作
而是一直等待io指令将外部输入的数据读进来再向下执行程序

而printf是你就不需要io的指令的结果,直接向下执行程序
![](img/Pasted%20image%2020220914021955.png)

什么是异步可以看
[../../OSandLinux/expansion/并行、并发、同步、异步的区别](../../OSandLinux/expansion/并行、并发、同步、异步的区别)